# SystemRequirements.md

## 1. 目的・背景
- 家庭内のiPadで、ファミレスのタブレット注文体験の雰囲気を味わえるデモ用Webサイトを提供する。
- 実注文・決済は行わず、UI/UXの体験を主目的とする。

## 2. 対象デバイス・動作環境
- 想定端末：iPad（10〜13インチ程度）
- 表示モード：**横画面（ランドスケープ）固定**
- 対応ブラウザ：Safari最新版、Chrome最新版（iOS/iPadOS）
- ネットワーク要件：オフライン動作は必須ではないが、初回読み込み後はローカル状態で操作可能。

## 3. スコープ
- 画面：トップページ（任意）、メニュー一覧画面、注文確認画面
- 右側固定ボタン群の表示・遷移（注文かごのみ実動、他はダミー）
- メニュー選択〜注文かごへの追加、かご内編集、注文確定モーダル表示まで

## 4. 画面一覧・遷移
### 右列固定ボタン（常時表示）
- 店員呼び出し（ダミー）
- トップページ
- クーポン番号（ダミー）
- お持ち帰り（ダミー）
- テーブル決済（ダミー）
- 注文履歴（ダミー）
- 注文かご（実動／バッジ表示あり）

### メニュー一覧画面
- 上段：店舗（ファミレスブランド）タブ
- 下段：選択店舗のメニューカテゴリタブ
- メイン：選択カテゴリ内のメニュー（名称／画像／価格／注文追加ボタン）

### 注文確認画面
- 注文かご一覧（削除／数量／小計／合計）
- 注文確定ボタン → モーダル「注文しました」表示 → メニュー一覧画面へ戻る

## 5. 機能要件
- 上段タブで店舗を切替 → 下段カテゴリ更新
- 下段カテゴリ選択でメニュー一覧表示更新
- 注文追加でかごに非同期追加、右列バッジ更新
- 注文確認画面で削除・合計再計算
- 注文確定でモーダル表示→かご初期化→一覧画面に戻る
- ダミーボタンはトーストで「準備中」表示

## 6. 非機能要件
- **画面方向**：横画面固定。縦画面では「横画面にしてください」オーバーレイ表示。
- **パフォーマンス**：主要操作（追加／削除）は100ms以内の応答を目標。
- **アクセシビリティ**：タブは`aria-selected`対応、ボタンにaria-label付与。
- **状態保持**：SPA内で保持。リロード時永続化は任意（LocalStorage対応可）。

## 7. オリジナルメニュー追加機能
- 上段タブに「オリジナル」を追加。
- 下段に「メニュー追加」タブ＋追加済みオリジナルタブを表示。
- メニュー追加タブで入力フォーム＆作成ボタン表示。
- 作成押下→生成AI API経由で画像生成→下段に追加タブ挿入。
- 最大8件まで保持。9件目追加で最古を削除。

## 8. PWA対応要件
- **ホーム画面に追加で全画面表示（standalone）**。
- manifest.jsonに`display: "standalone"`, `orientation: "landscape"`。
- App Shellをキャッシュし、オフライン時でもUI表示可能。
- オリジナル画像はIndexedDBに保存、オフライン時は再利用。
- サービスワーカーでApp Shellキャッシュ更新／不要キャッシュ削除。

## 9. データモデル例
```json
{
  "stores": [
    {
      "id": "bami",
      "name": "バーミヤン",
      "categories": [
        {
          "id": "ramen",
          "name": "ラーメン",
          "items": [
            { "id": "ramen_shoyu", "name": "醤油ラーメン", "price": 690, "image": "/img/ramen.jpg" }
          ]
        }
      ]
    }
  ],
  "cart": {
    "items": [
      { "itemId": "ramen_shoyu", "name": "醤油ラーメン", "unitPrice": 690, "qty": 1, "image": "/img/ramen.jpg" }
    ]
  },
  "original": {
    "items": [
      { "id": "uuid-1", "name": "オリジナルラーメン", "image": "data:image/png;base64,...", "createdAt": 173829283 }
    ]
  }
}
```

## 10. 受け入れ基準
1. 店舗／カテゴリ選択で正しく画面が更新されること。
2. 注文追加でかご件数が増加し、画面遷移しないこと。
3. 注文確認画面で削除・合計再計算が行われること。
4. 注文確定でモーダル表示後にかごが初期化されること。
5. オリジナルメニュー追加が最大8件保持され、9件目追加時に最古が削除されること。
6. ホーム画面追加から起動した場合、全画面（アドレスバー無し）で利用できること。
7. オフライン時でもApp Shellと保存済みオリジナル画像が表示できること。
