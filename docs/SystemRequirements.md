# SystemRequirements.md

## 1. 目的・背景
- 家庭内のiPadで、ファミレスのタブレット注文体験の雰囲気を味わえるデモ用Webサイトを提供する。
- 実注文・決済は行わず、UI/UXの体験を主目的とする。

## 2. 対象デバイス・動作環境
- 想定端末：iPad（10〜13インチ程度）
- 表示モード：**横画面（ランドスケープ）固定**
- 対応ブラウザ：Safari最新版、Chrome最新版（iOS/iPadOS）
- ネットワーク要件：オフライン動作は必須ではないが、初回読み込み後はローカル状態で操作可能。

## 3. スコープ
- 画面：トップページ（任意）、メニュー一覧画面、注文確認画面
- 右側固定ボタン群の表示・遷移（注文かごのみ実動、他はダミー）
- メニュー選択〜注文かごへの追加、かご内編集、注文確定モーダル表示まで

## 4. 画面一覧・遷移
### 右列固定ボタン（常時表示）
- 店員呼び出し（ダミー）
- トップページ
- クーポン番号（ダミー）
- お持ち帰り（ダミー）
- テーブル決済（ダミー）
- 注文履歴（ダミー）
- 注文かご（実動／バッジ表示あり）

### メニュー一覧画面
- 上段：店舗（ファミレスブランド）タブ
- 下段：選択店舗のカテゴリをタブとして表示（例：点心・餃子、前菜・サラダ、麺、など）
- メイン：選択カテゴリの4つのメニューを2×2グリッド表示（各カード：画像／名称／価格）
  - グリッドの左側：「< 前のページ」ボタン
  - グリッドの右側：「> 次のページ」ボタン
- ページネーション：
  - カテゴリ内のメニューを4件ずつページ分割して表示
  - 「次のページ」押下：カテゴリ内の次ページへ。最終ページの場合は次カテゴリの1ページ目へ（最後のカテゴリの場合は最初のカテゴリへループ）
  - 「前のページ」押下：カテゴリ内の前ページへ。最初のページの場合は前カテゴリの最終ページへ（最初のカテゴリの場合は最後のカテゴリへループ）
- メニューカード押下：メニュー詳細画面へ遷移

### メニュー詳細画面
- 選択メニューを大きく表示（画像／名称／価格／「注文に追加」ボタン）
- 戻るボタンでメニュー一覧画面に戻る

### 注文確認画面
- 注文かご一覧（削除／数量／小計／合計）
- 注文確定ボタン → モーダル「注文しました」表示 → メニュー一覧画面へ戻る

## 5. 機能要件
- 上段タブで店舗を切替 → 下段に選択店舗のカテゴリタブ表示
- 下段カテゴリタブ選択でメイン画面に該当カテゴリの4メニューをグリッド表示
- ページネーションボタンでカテゴリ内/カテゴリ間のページ移動
  - 「次のページ」：カテゴリ内の次ページへ。最終ページなら次カテゴリの1ページ目へ（循環）
  - 「前のページ」：カテゴリ内の前ページへ。最初のページなら前カテゴリの最終ページへ（循環）
- メニューカード押下 → メニュー詳細画面へ遷移
- メニュー詳細画面で「注文に追加」ボタン押下 → かごに非同期追加、右列バッジ更新、一覧画面に戻る
- 注文確認画面で削除・合計再計算
- 注文確定でモーダル表示→かご初期化→一覧画面に戻る
- ダミーボタンはトーストで「準備中」表示

## 6. 非機能要件
- **画面方向**：横画面固定。縦画面では「横画面にしてください」オーバーレイ表示。
- **パフォーマンス**：主要操作（追加／削除）は100ms以内の応答を目標。
- **アクセシビリティ**：タブは`aria-selected`対応、ボタンにaria-label付与。
- **状態保持**：SPA内で保持。リロード時永続化は任意（LocalStorage対応可）。

## 7. オリジナルメニュー追加機能
- 上段タブに「オリジナル」を追加。
- 下段に「メニュー追加」カテゴリタブを表示。
- メニュー追加タブ選択時、メイン画面に入力フォーム＆作成ボタン表示。
- 作成押下→生成AI API経由で画像生成→オリジナルメニューとして保存。
- 最大8件まで保持。9件目追加で最古を削除。
- 保存されたオリジナルメニューは「オリジナル」カテゴリに表示され、通常メニューと同様に注文可能（999円固定）。

## 8. PWA対応要件
- **ホーム画面に追加で全画面表示（standalone）**。
- manifest.jsonに`display: "standalone"`, `orientation: "landscape"`。
- App Shellをキャッシュし、オフライン時でもUI表示可能。
- オリジナル画像はIndexedDBに保存、オフライン時は再利用。
- サービスワーカーでApp Shellキャッシュ更新／不要キャッシュ削除。

## 9. データモデル例
```json
{
  "stores": [
    {
      "id": "bami",
      "name": "バーミヤン",
      "items": [
        { "id": "ramen_shoyu", "name": "醤油ラーメン", "price": 690, "image": "/img/ramen.jpg", "category": "ラーメン" },
        { "id": "gyoza_teishoku", "name": "餃子定食", "price": 890, "image": "/img/gyoza.jpg", "category": "定食" }
      ]
    }
  ],
  "cart": {
    "items": [
      { "itemId": "ramen_shoyu", "name": "醤油ラーメン", "unitPrice": 690, "qty": 1, "image": "/img/ramen.jpg" }
    ]
  },
  "original": {
    "items": [
      { "id": "uuid-1", "name": "オリジナルラーメン", "image": "data:image/png;base64,...", "createdAt": 173829283 }
    ]
  }
}
```

**注記**: カテゴリは各メニューアイテムの属性として保持します。下段タブにはカテゴリを表示し、メイン画面では選択カテゴリの4メニューを2×2グリッド表示します。

## 10. 受け入れ基準
1. 店舗選択で下段に選択店舗のカテゴリがタブとして表示されること。
2. 下段カテゴリタブ選択でメイン画面に該当カテゴリの4メニューが2×2グリッド表示されること。
3. グリッドの左右にページネーションボタンが表示されること。
4. 「次のページ」押下でカテゴリ内の次ページに移動すること。カテゴリ最終ページの場合は次カテゴリの1ページ目へ遷移すること。
5. 「前のページ」押下でカテゴリ内の前ページに移動すること。カテゴリ最初のページの場合は前カテゴリの最終ページへ遷移すること。
6. 最後のカテゴリから「次のページ」で最初のカテゴリへ循環すること。
7. 最初のカテゴリから「前のページ」で最後のカテゴリへ循環すること。
8. メニューカード押下でメニュー詳細画面に遷移すること。
9. メニュー詳細画面で「注文に追加」押下後、かご件数が増加し一覧画面に戻ること。
10. 注文確認画面で削除・合計再計算が行われること。
11. 注文確定でモーダル表示後にかごが初期化されること。
12. オリジナルメニュー追加が最大8件保持され、9件目追加時に最古が削除されること。
13. ホーム画面追加から起動した場合、全画面（アドレスバー無し）で利用できること。
14. オフライン時でもApp Shellと保存済みオリジナル画像が表示できること。
